<div class='ui container'>
  <div class='ui grid'>
    <div class='ui sixteen column'>
       <div class="collapse" id="collapseExample">
        <div class="card card-body">
            <h5>Shift slots</h5>
            {%for s in slots%}<div style="background-color:{{s.color_in_calendar}};color:#FFFFFF;">{{s.name}} <strong>({{s.abbreviation}})</strong> for <strong>{{s.hour_start}}</strong> - <strong>{{s.hour_end}}</strong> </div>{% endfor%}
        </div>
      </div>
      <div id='calendar' style="padding-top: 10px;"></div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
      //plugins: ['dayGrid', 'dayGridPlugin' ],
      themeSystem: 'bootstrap',
      customButtons: {
        legend: {
          text: 'What are the colors?',
          click: function() {
            $('.collapse').toggle();
          }
        }
      },
      headerToolbar: { left: 'prev,today,next',
                center:'title',
                right: 'legend, dayGridMonth,timeGridWeek',
              },
      //initialView: 'dayGridWeek', //TODO
      columnFormat: {
            month: 'ddd',
            week: 'ddd M/d',
        },
      initialDate: '{{defaultDate}}',
      weekNumbers: true,
      navLinks: true, // can click day/week names to navigate views
      editable: false,
      firstDay:1, // Monday
      businessHours: [
         {
          daysOfWeek: [ 1, 2, 3, 4, 5 ],
           startTime: '08:00', // 8am
           endTime: '18:00' // 6pm
         },],
      eventLimit: true, // allow 'more' link when too many events
      eventDisplay: 'block',
      eventOrder: "start,id,name,title",
      eventSources: [
        {
          events:[
            {% for shift in scheduled_shifts_list %}
            {
            id: {{forloop.counter}}, //shifts are sorted with roles
            title: '{{shift.member.first_name}} as {% if shift.role != null %}{{shift.role}} ({{shift.member.role}}){%else%}{{shift.member.role}}{%endif%}',
            start:'{{ shift.shift_start }}',
            end:'{{ shift.shift_end }}',
            url:'/u?id={{shift.member.id}}',
            {% if 'ShiftLeader' in shift.member.role.name %} textColor: '#E9E72D',{% endif %}
            color:'{{shift.slot.color_in_calendar}}',
            },
            {% endfor %}
            {% for study in scheduled_studies_list %}
            {
            id: {{forloop.counter}}, //shifts are sorted with roles
            title: '{{study.member.first_name}} for {{study.title}}',
            start:'{{ study.study_start }}',
            end:'{{ study.study_end }}',
            url:'/u?id={{study.member.id}}',
            color: '#F5D959',
            textColor: '#676767',
            {% if study.priority %} borderColor: '#FF3333', textColor: '#FF3333', {% endif %}
            },
            {% endfor %}
            {% for ph in publicHolidays %}
            {
            start:'{{ ph }}',
            end:'{{ ph }}',
            overlap: false,
            display: 'background'
            },
            {% endfor %}
            ],
          textColor: '#FFFFFF' // regular color
          }
        ]
    });

    calendar.render();
  });
    </script>